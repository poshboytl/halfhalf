# Half & Half Design

## æ ¸å¿ƒå®šä½

Half & Half æ˜¯ **OpenClaw ä¸“å±å®¢æˆ·ç«¯**ï¼Œä¸æ˜¯é€šç”¨ AI èŠå¤©å·¥å…·ã€‚

## æ¶æ„åŸåˆ™

### ğŸ  æœ¬æœºéƒ¨ç½²

**Half & Half æœåŠ¡ç«¯å¿…é¡»è¿è¡Œåœ¨ OpenClaw Gateway æ‰€åœ¨çš„æœºå™¨ä¸Šã€‚**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         OpenClaw ä¸»æœº (Mac mini)         â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Half & Half  â”‚â”€â”€â”€â–¶â”‚   Gateway    â”‚  â”‚
â”‚  â”‚   (Rails)    â”‚    â”‚  (loopback)  â”‚  â”‚
â”‚  â”‚  0.0.0.0:3000â”‚    â”‚ 127.0.0.1    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â–²                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚ Tailscale / LAN / Web
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚  æµè§ˆå™¨    â”‚
    â”‚ (ä»»ä½•è®¾å¤‡) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸ºä»€ä¹ˆï¼š**
1. Gateway ä¿æŒ loopback ç»‘å®šï¼Œæœ€å®‰å…¨
2. Half & Half é€šè¿‡ localhost è¿æ¥ Gatewayï¼Œæ— éœ€é…ç½® TLS
3. ç”¨æˆ·é€šè¿‡ç½‘ç»œè®¿é—® Half & Half Web UI
4. é¿å…æš´éœ² Gateway åˆ°ç½‘ç»œçš„å¤æ‚æ€§å’Œé£é™©

### ğŸ”Œ è¿æ¥æ–¹å¼

- **Half & Half â†’ Gateway**: `ws://127.0.0.1:18789` (localhost)
- **æµè§ˆå™¨ â†’ Half & Half**: `http://<host>:3000` (Tailscale/LAN)

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

1. **Sub-agents å¯è§†åŒ–** - å¹¶è¡Œä»»åŠ¡çš„ç›´è§‚å±•ç¤º
2. **Tool calls å±•ç¤º** - çœ‹åˆ° agent åœ¨åšä»€ä¹ˆ
3. **Memory æŸ¥çœ‹å™¨** - æµè§ˆ workspace æ–‡ä»¶
4. **æ›´å¥½çš„æ¸²æŸ“** - Markdownã€ä»£ç é«˜äº®ã€æµå¼è¾“å‡º

## æŠ€æœ¯æ ˆ

- **åç«¯**: Rails 8 + Hotwire
- **å‰ç«¯**: Tailwind CSS + Stimulus
- **å®æ—¶**: Turbo Streams + SSE
- **æœªæ¥**: Go + Bubble Tea (TUI ç‰ˆæœ¬)

## é…ç½®

### Gateway è¿æ¥

```ruby
# config/openclaw.yml
gateway:
  url: "ws://127.0.0.1:18789"
  # æ°¸è¿œæ˜¯ localhostï¼Œä¸éœ€è¦æ”¹
```

### æœåŠ¡å™¨ç»‘å®š

```bash
# å¼€å‘ç¯å¢ƒ
bin/dev  # è‡ªåŠ¨ç»‘å®š 0.0.0.0:3000

# ç”Ÿäº§ç¯å¢ƒ
bin/rails server -b 0.0.0.0 -p 3000
```

## å†³ç­–è®°å½•

### 2026-02-22: æœ¬æœºéƒ¨ç½²åŸåˆ™

**èƒŒæ™¯**: å°è¯•è®© Gateway ç»‘å®š Tailscale IP + TLSï¼Œç»“æœé…ç½®é”™è¯¯å¯¼è‡´å¤±è”ã€‚

**å†³ç­–**: Half & Half æœåŠ¡ç«¯æ°¸è¿œå’Œ Gateway åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œé€šè¿‡ localhost è¿æ¥ã€‚

**å¥½å¤„**:
- ä¸éœ€è¦æ”¹ Gateway é…ç½®
- ä¸éœ€è¦ TLS
- æ›´ç®€å•ã€æ›´å®‰å…¨
